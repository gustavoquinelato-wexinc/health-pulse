<!DOCTYPE html>
<html lang="en" data-theme="{{ color_schema.theme if color_schema and color_schema.theme else 'light' }}" data-color-schema="{{ color_schema.mode if color_schema and color_schema.mode else 'default' }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Pulse ETL{% endblock %}</title>
    <link rel="icon" type="image/svg+xml" href="/static/heart-pulse.svg">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="/static/css/etl-service.css?v=light-neutral-buttons" rel="stylesheet">

    <!-- Server-side color schema data -->
    {% if color_schema %}
    <script type="application/json" id="server-color-schema">{{ color_schema | tojson }}</script>
    {% endif %}

    <!-- Load colors immediately to prevent flashing -->
    <script>
        // Load colors from URL parameters first, then localStorage, then server-side data
        (function() {
            try {
                // Check if color data was passed via URL parameters (from frontend)
                const urlParams = new URLSearchParams(window.location.search);
                const urlColorData = urlParams.get('color_data');
                const urlTheme = urlParams.get('theme');
                const urlMode = urlParams.get('mode');

                // If URL has color data, store it in localStorage for future use
                if (urlColorData) {
                    try {
                        const decodedColorData = decodeURIComponent(urlColorData);
                        localStorage.setItem('pulse_complete_color_data', decodedColorData);
                        if (urlTheme) localStorage.setItem('pulse_theme', urlTheme);
                        if (urlMode) localStorage.setItem('pulse_color_schema_mode', urlMode);


                        // Clean up URL to remove color data parameters
                        const cleanUrl = window.location.pathname;
                        window.history.replaceState({}, document.title, cleanUrl);
                    } catch (e) {
                        console.warn('Failed to process color data from URL:', e);
                    }
                }

                // Now try localStorage complete color data (most up-to-date)
                const savedTheme = localStorage.getItem('pulse_theme') || 'light';
                const savedColorSchemaMode = localStorage.getItem('pulse_color_schema_mode') || 'default';
                const completeColorData = localStorage.getItem('pulse_complete_color_data');

                let colorsApplied = false;



                if (completeColorData) {
                    try {
                        const allColors = JSON.parse(completeColorData);


                        const targetColors = allColors.find(function(c) {
                            return c.color_schema_mode === savedColorSchemaMode &&
                                   c.theme_mode === savedTheme &&
                                   c.accessibility_level === 'regular';
                        });



                        if (targetColors) {
                            document.documentElement.setAttribute('data-theme', savedTheme);
                            document.documentElement.setAttribute('data-color-schema', savedColorSchemaMode);

                            const root = document.documentElement;
                            root.style.setProperty('--color-1', targetColors.color1);
                            root.style.setProperty('--color-2', targetColors.color2);
                            root.style.setProperty('--color-3', targetColors.color3);
                            root.style.setProperty('--color-4', targetColors.color4);
                            root.style.setProperty('--color-5', targetColors.color5);

                            // Set gradient variables
                            root.style.setProperty('--gradient-1-2', `linear-gradient(135deg, ${targetColors.color1} 0%, ${targetColors.color2} 100%)`);
                            root.style.setProperty('--gradient-2-3', `linear-gradient(135deg, ${targetColors.color2} 0%, ${targetColors.color3} 100%)`);
                            root.style.setProperty('--gradient-3-4', `linear-gradient(135deg, ${targetColors.color3} 0%, ${targetColors.color4} 100%)`);
                            root.style.setProperty('--gradient-4-5', `linear-gradient(135deg, ${targetColors.color4} 0%, ${targetColors.color5} 100%)`);
                            root.style.setProperty('--gradient-5-1', `linear-gradient(135deg, ${targetColors.color5} 0%, ${targetColors.color1} 100%)`);

                            // Apply on-colors if available
                            if (targetColors.on_color1) {
                                root.style.setProperty('--on-color-1', targetColors.on_color1);
                                root.style.setProperty('--on-color-2', targetColors.on_color2);
                                root.style.setProperty('--on-color-3', targetColors.on_color3);
                                root.style.setProperty('--on-color-4', targetColors.on_color4);
                                root.style.setProperty('--on-color-5', targetColors.on_color5);
                            }

                            // Apply gradient on-colors if available
                            if (targetColors.on_gradient_1_2) {
                                root.style.setProperty('--on-gradient-1-2', targetColors.on_gradient_1_2);
                                root.style.setProperty('--on-gradient-2-3', targetColors.on_gradient_2_3);
                                root.style.setProperty('--on-gradient-3-4', targetColors.on_gradient_3_4);
                                root.style.setProperty('--on-gradient-4-5', targetColors.on_gradient_4_5);
                                root.style.setProperty('--on-gradient-5-1', targetColors.on_gradient_5_1);
                            }

                            colorsApplied = true;

                        }
                    } catch (e) {
                        console.warn('Failed to parse complete color data from localStorage');
                    }
                }

                // Fallback to server-side color schema data if localStorage didn't work
                if (!colorsApplied) {

                    const serverSchemaElement = document.getElementById('server-color-schema');
                    if (serverSchemaElement) {
                    const serverColorSchema = JSON.parse(serverSchemaElement.textContent);

                    const theme = serverColorSchema.theme || 'light';
                    const colorSchemaMode = serverColorSchema.mode || 'default';

                    document.documentElement.setAttribute('data-theme', theme);
                    document.documentElement.setAttribute('data-color-schema', colorSchemaMode);

                    // Apply active colors (default or custom) from server; compute on-colors if missing
                    if (serverColorSchema.colors) {
                        const colors = serverColorSchema.colors;
                        const root = document.documentElement;
                        root.style.setProperty('--color-1', colors.color1);
                        root.style.setProperty('--color-2', colors.color2);
                        root.style.setProperty('--color-3', colors.color3);
                        root.style.setProperty('--color-4', colors.color4);
                        root.style.setProperty('--color-5', colors.color5);

                        // Set gradient variables
                        root.style.setProperty('--gradient-1-2', `linear-gradient(135deg, ${colors.color1} 0%, ${colors.color2} 100%)`);
                        root.style.setProperty('--gradient-2-3', `linear-gradient(135deg, ${colors.color2} 0%, ${colors.color3} 100%)`);
                        root.style.setProperty('--gradient-3-4', `linear-gradient(135deg, ${colors.color3} 0%, ${colors.color4} 100%)`);
                        root.style.setProperty('--gradient-4-5', `linear-gradient(135deg, ${colors.color4} 0%, ${colors.color5} 100%)`);
                        root.style.setProperty('--gradient-5-1', `linear-gradient(135deg, ${colors.color5} 0%, ${colors.color1} 100%)`);

                        // Apply on-colors if provided; compute fallback if missing
                        const on = serverColorSchema.on_colors || {};
                        const onGrad = serverColorSchema.on_gradients || {};
                        const pickOn = (hex) => {
                            try {
                                const h = hex.replace('#','');
                                const r = parseInt(h.slice(0,2), 16) / 255;
                                const g = parseInt(h.slice(2,4), 16) / 255;
                                const b = parseInt(h.slice(4,6), 16) / 255;
                                const lin = (c) => (c <= 0.03928 ? c/12.92 : Math.pow((c+0.055)/1.055, 2.4));
                                const L = 0.2126*lin(r) + 0.7152*lin(g) + 0.0722*lin(b);
                                const contrast = (Lbg, Lfg) => (Math.max(Lbg, Lfg) + 0.05) / (Math.min(Lbg, Lfg) + 0.05);
                                const cBlack = contrast(L, 0);
                                const cWhite = contrast(L, 1);
                                return cWhite >= cBlack ? '#FFFFFF' : '#000000';
                            } catch { return '#000000'; }
                        };
                        const pairOn = (a, b) => {
                            const onA = pickOn(a), onB = pickOn(b);
                            return onA === onB ? onA : '#FFFFFF';
                        };
                        root.style.setProperty('--on-color-1', on.color1 || pickOn(colors.color1));
                        root.style.setProperty('--on-color-2', on.color2 || pickOn(colors.color2));
                        root.style.setProperty('--on-color-3', on.color3 || pickOn(colors.color3));
                        root.style.setProperty('--on-color-4', on.color4 || pickOn(colors.color4));
                        root.style.setProperty('--on-color-5', on.color5 || pickOn(colors.color5));
                        root.style.setProperty('--on-gradient-1-2', onGrad['1-2'] || pairOn(colors.color1, colors.color2));
                        root.style.setProperty('--on-gradient-2-3', onGrad['2-3'] || pairOn(colors.color2, colors.color3));
                        root.style.setProperty('--on-gradient-3-4', onGrad['3-4'] || pairOn(colors.color3, colors.color4));
                        root.style.setProperty('--on-gradient-4-5', onGrad['4-5'] || pairOn(colors.color4, colors.color5));
                    }
                } else {
                    // No server-side data available, set basic theme attributes
                    document.documentElement.setAttribute('data-theme', savedTheme);
                    document.documentElement.setAttribute('data-color-schema', savedColorSchemaMode);

                }
                }
            } catch (error) {
                console.error('Error loading color schema:', error);
                // Fallback to default theme if anything goes wrong
                document.documentElement.setAttribute('data-theme', 'light');
                document.documentElement.setAttribute('data-color-schema', 'default');
            }
        })();
    </script>

    {% block extra_head %}{% endblock %}
</head>
<body style="background-color: var(--bg-primary);" {% if embedded %}class="embedded"{% endif %}>
    <div class="min-h-screen" style="background-color: var(--bg-primary);">
        {% if not embedded %}
        <!-- Header - Full Width at Top -->
        {% from 'components/header.html' import header %}
        {{ header(title='PULSE ETL MANAGEMENT', client_logo=client_logo, client_name=client_name) }}
        {% endif %}

        <!-- Content Area Below Header -->
        <div class="flex">
            {% if not embedded %}
            <!-- Sidebar - Fixed Position Below Header -->
            {% from 'components/sidebar.html' import sidebar %}
            {{ sidebar(current_path=request.path if request else '') }}
            {% endif %}

            <!-- Main Content - Conditional margin for sidebar -->
            <main class="flex-1 {% if not embedded %}p-6 ml-16{% else %}embedded{% endif %}">
                {% block content %}{% endblock %}
            </main>
        </div>
    </div>

    <!-- Base JavaScript -->
    <script>
        // Navigation Active State (specific to layout)
        function updateActiveNavigation() {
            const currentPath = window.location.pathname;
            const navItems = document.querySelectorAll('.nav-item');

            navItems.forEach(item => {
                const path = item.getAttribute('data-path');
                if (currentPath.startsWith(path)) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
        }

        // Global user data
        let currentUser = null;

        // Authentication helper (prefer cookie token; keep localStorage in sync)
        function getAuthToken() {
            const cookieToken = getCookie('pulse_token');
            let lsToken = localStorage.getItem('pulse_token');
            if (cookieToken && cookieToken !== lsToken) {
                localStorage.setItem('pulse_token', cookieToken);
                lsToken = cookieToken;
            }
            return lsToken || cookieToken || null;
        }

        // Helper function to get user initials (prefer first/last; fill missing from email username parts)
        function getUserInitials(user) {
            if (!user) return 'U';

            const first = (user.first_name || '').trim();
            const last = (user.last_name || '').trim();
            const fi = first ? first[0] : '';
            const li = last ? last[0] : '';

            // If both provided
            if (fi && li) return (fi + li).toUpperCase();

            // Derive from email username
            const uname = (user.email || '').split('@')[0];
            const parts = uname.split(/[.\-_]+/).filter(Boolean);

            if (fi && !li) {
                const second = (parts[1]?.[0]) || (parts[0]?.[1]) || '';
                const res = (fi + (second || '')).toUpperCase();
                return res || 'U';
            }
            if (!fi && li) {
                const firstFromEmail = (parts[0]?.[0]) || '';
                const res = ((firstFromEmail || '') + li).toUpperCase();
                return res || 'U';
            }

            // No names: use email parts
            if (parts.length >= 2) return (parts[0][0] + parts[1][0]).toUpperCase();
            if (parts.length === 1 && parts[0]) return parts[0].slice(0, 2).toUpperCase();
            return 'U';
        }

        // Load user information
        async function loadUserInfo() {
            try {
                const token = getAuthToken();
                if (!token) {
                    console.warn('No auth token available for user info');
                    return;
                }

                const response = await fetch('/api/v1/auth/validate', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    if (data.valid && data.user) {
                        currentUser = data.user;
                        updateUserDisplay();
                    }
                } else if (response.status === 401) {
                    console.warn('User token validation failed - user may need to re-login');
                    // Don't redirect here - let individual pages handle authentication
                }
            } catch (error) {
                console.error('Error loading user info:', error);
            }
        }

        // Update user display in header
        function updateUserDisplay() {
            if (!currentUser) return;

            // Format user name
            const userName = (currentUser.first_name && currentUser.last_name)
                ? `${currentUser.first_name} ${currentUser.last_name}`
                : (currentUser.first_name || currentUser.last_name)
                    ? (currentUser.first_name || currentUser.last_name)
                    : (currentUser.email ? currentUser.email.split('@')[0] : 'User');

            // Update user initials
            const userInitialsElement = document.getElementById('user-initials');
            if (userInitialsElement) {
                userInitialsElement.textContent = getUserInitials(currentUser);
            }

            // Update user name in button (always prefer First + Last when available)
            const userNameElement = document.getElementById('user-name');
            if (userNameElement) {
                const uname = (currentUser.email || '').split('@')[0];
                const parts = uname.split(/[.\-_]+/).filter(Boolean);
                const toTitle = s => s ? (s[0].toUpperCase() + s.slice(1).toLowerCase()) : '';
                const preferredName = (currentUser.first_name && currentUser.last_name)
                    ? `${toTitle(currentUser.first_name)} ${toTitle(currentUser.last_name)}`
                    : (currentUser.first_name || currentUser.last_name)
                        ? toTitle(currentUser.first_name || currentUser.last_name)
                        : parts.length >= 2
                            ? `${toTitle(parts[0])} ${toTitle(parts[1])}`
                            : toTitle(uname);
                userNameElement.textContent = preferredName;
            }

            // Update dropdown display
            const userNameDisplay = document.getElementById('user-name-display');
            if (userNameDisplay) {
                const uname = (currentUser.email || '').split('@')[0];
                const parts = uname.split(/[.\-_]+/).filter(Boolean);
                const toTitle = s => s ? (s[0].toUpperCase() + s.slice(1).toLowerCase()) : '';
                const preferredName = (currentUser.first_name && currentUser.last_name)
                    ? `${toTitle(currentUser.first_name)} ${toTitle(currentUser.last_name)}`
                    : (currentUser.first_name || currentUser.last_name)
                        ? toTitle(currentUser.first_name || currentUser.last_name)
                        : parts.length >= 2
                            ? `${toTitle(parts[0])} ${toTitle(parts[1])}`
                            : toTitle(uname);
                userNameDisplay.textContent = preferredName;
            }

            const userEmailDisplay = document.getElementById('user-email-display');
            if (userEmailDisplay) {
                userEmailDisplay.textContent = currentUser.email;
            }

            const userRoleDisplay = document.getElementById('user-role-display');
            if (userRoleDisplay) {
                userRoleDisplay.textContent = currentUser.role;
            }
        }

        // Theme Management
        async function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';

            // Update UI immediately for responsiveness
            html.setAttribute('data-theme', newTheme);
            const icon = document.getElementById('theme-icon');
            if (icon) {
                icon.className = newTheme === 'light' ? 'fas fa-moon' : 'fas fa-sun';
            }

            // Save to database for cross-browser sync
            try {
                // Get current auth token
                const token = getCookie('pulse_token');
                if (!token) {
                    console.warn('ETL Service: No auth token found for theme update');
                    return;
                }

                // Call backend service directly for user theme update
                const backendUrl = window.location.protocol + '//' + window.location.hostname + ':3001';
                const response = await fetch(`${backendUrl}/api/v1/user/theme-mode`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({ mode: newTheme })
                });

                if (response.ok) {
                    console.log('ETL Service: Theme saved to database:', newTheme);
                    // Update localStorage for caching
                    localStorage.setItem('pulse_theme', newTheme);
                } else {
                    console.warn('ETL Service: Failed to save theme to database');
                    // Revert UI change if database update failed
                    html.setAttribute('data-theme', currentTheme);
                    if (icon) {
                        icon.textContent = currentTheme === 'light' ? 'ðŸŒ™' : 'â˜€ï¸';
                    }
                }
            } catch (error) {
                console.error('ETL Service: Error saving theme to database:', error);
                // Revert UI change if database update failed
                html.setAttribute('data-theme', currentTheme);
                if (icon) {
                    icon.textContent = currentTheme === 'light' ? 'ðŸŒ™' : 'â˜€ï¸';
                }
            }
        }

        // Helper function to get cookie value
        function getCookie(name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) return parts.pop().split(';').shift();
            return null;
        }

        // User Menu
        function toggleUserMenu(event) {
            if (event) {
                event.stopPropagation();
            }
            const menu = document.getElementById('user-menu');
            if (menu) {
                menu.classList.toggle('hidden');
            }
        }

        // Close user menu on outside click
        document.addEventListener('click', function(e) {
            const userMenu = document.getElementById('user-menu');
            const userButton = e.target.closest('[onclick*="toggleUserMenu"]');
            if (userMenu && !userButton && !userMenu.contains(e.target)) {
                userMenu.classList.add('hidden');
            }
        });

        // Initialize layout
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize theme - respect server-side setting if available
            const currentTheme = document.documentElement.getAttribute('data-theme') || localStorage.getItem('pulse_theme') || 'light';
            document.documentElement.setAttribute('data-theme', currentTheme);
            const icon = document.getElementById('theme-icon');
            if (icon) {
                icon.className = currentTheme === 'light' ? 'fas fa-moon' : 'fas fa-sun';
            }

            // Cross-browser theme sync completely removed to prevent infinite API calls

            // Load user information
            loadUserInfo();

            // Update navigation active state
            updateActiveNavigation();

            // Handle submenu mouse leave events
            document.querySelectorAll('[id^="submenu-"]').forEach(submenu => {
                submenu.addEventListener('mouseleave', () => {
                    setTimeout(() => {
                        isHoveringSubmenu = false;
                        currentSubmenu = null;
                        submenu.classList.add('hidden');
                    }, 100);
                });
            });
        });

        // Generic Modal Functions
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('hidden');
                modal.classList.add('flex');
            }
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add('hidden');
                modal.classList.remove('flex');
            }
        }

        // Sidebar Submenu functionality - Global scope
        let hoverTimeout = null;
        let currentSubmenu = null;
        let isHoveringSubmenu = false;

        function showSubmenu(event, menuType) {
            clearTimeout(hoverTimeout);

            const rect = event.currentTarget.getBoundingClientRect();
            const viewportHeight = window.innerHeight;
            const submenuHeight = 120; // Estimate submenu height

            // Calculate optimal Y position
            let yPosition = rect.top;
            if (rect.top + submenuHeight > viewportHeight) {
                yPosition = rect.bottom - submenuHeight;
            }

            // Hide current submenu if different
            if (currentSubmenu && currentSubmenu !== menuType) {
                document.getElementById(`submenu-${currentSubmenu}`).classList.add('hidden');
            }

            // Show new submenu
            const submenu = document.getElementById(`submenu-${menuType}`);
            if (submenu) {
                submenu.style.left = `${rect.right + 8}px`; // Position to the right of the icon with 8px gap
                submenu.style.top = `${yPosition}px`;
                submenu.style.zIndex = '1000';
                submenu.style.position = 'fixed';
                submenu.classList.remove('hidden');
                currentSubmenu = menuType;
            }
        }

        function hideSubmenu() {
            clearTimeout(hoverTimeout);
            hoverTimeout = setTimeout(() => {
                if (!isHoveringSubmenu) {
                    currentSubmenu = null;
                    document.querySelectorAll('[id^="submenu-"]').forEach(el => {
                        el.classList.add('hidden');
                    });
                }
            }, 200); // 200ms delay like frontend
        }

        function keepSubmenuOpen() {
            clearTimeout(hoverTimeout);
            isHoveringSubmenu = true;
        }

        // Navigation function - Global scope
        function navigateTo(path) {
            window.location.href = path;
        }

        // Return to Dashboard function
        function returnToDashboard() {
            // Navigate without passing token in the URL. Authentication uses shared cookie.
            const FRONTEND_URL = 'http://localhost:3000';
            window.location.href = `${FRONTEND_URL}/home`;
        }

        // Handle token parameter and clean up URL
        function handleTokenParameter() {
            const urlParams = new URLSearchParams(window.location.search);
            const urlToken = urlParams.get('token');

            if (urlToken) {
                // Store token in cookie (it should already be there from POST navigation, but just in case)
                document.cookie = `pulse_token=${urlToken}; path=/; max-age=3600; SameSite=Lax`;

                // Clean up URL by removing token parameter
                const newUrl = new URL(window.location.href);
                newUrl.searchParams.delete('token');
                window.history.replaceState({}, document.title, newUrl.toString());

                console.log('Token parameter processed and URL cleaned');
            }
        }

        // Update the pulse link href dynamically when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Handle token parameter first
            handleTokenParameter();

            // Update pulse link href
            const pulseLink = document.getElementById('pulse-link');
            if (pulseLink) {
                const token = getCookie('pulse_token');
                const FRONTEND_URL = 'http://localhost:3000';

                if (token) {
                    pulseLink.href = `${FRONTEND_URL}/home?token=${encodeURIComponent(token)}`;
                } else {
                    pulseLink.href = `${FRONTEND_URL}/home`;
                }
            }
        });

        // Helper function to get cookie value
        function getCookie(name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) return parts.pop().split(';').shift();
            return null;
        }

        function confirmAction(modalId) {
            // This function should be overridden by specific pages
            // that need custom confirmation logic
            console.warn(`confirmAction called for ${modalId} but no specific handler defined`);
            closeModal(modalId);
        }

        // Close modal on ESC key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const openModals = document.querySelectorAll('.fixed.inset-0:not(.hidden)');
                openModals.forEach(modal => {
                    if (modal.id) {
                        closeModal(modal.id);
                    }
                });
            }
        });

        // Close modal on backdrop click
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('fixed') && e.target.classList.contains('inset-0')) {
                const modalId = e.target.id;
                if (modalId) {
                    closeModal(modalId);
                }
            }
        });

        // Logout function
        async function logout() {
            try {
                // Get current token
                const token = getAuthToken();

                if (token) {
                    // Call ETL logout endpoint to invalidate session
                    try {
                        const response = await fetch('/api/logout', {
                            method: 'POST',
                            headers: {
                                'Authorization': `Bearer ${token}`,
                                'Content-Type': 'application/json'
                            }
                        });
                    } catch (error) {
                        // Silently handle server logout errors
                    }
                }

                // Clear all authentication data
                localStorage.removeItem('pulse_token');
                document.cookie = 'pulse_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT; SameSite=Lax';

                // Clear any axios default headers
                if (window.axios && window.axios.defaults) {
                    delete window.axios.defaults.headers.common['Authorization'];
                }

                // Redirect to login page
                window.location.href = '/login';

            } catch (error) {
                // Still redirect to login even if there's an error
                window.location.href = '/login';
            }
        }
    </script>
    
    {% block extra_scripts %}{% endblock %}
</body>
</html>
